(this.webpackJsonphelloworld=this.webpackJsonphelloworld||[]).push([[0],{121:function(e,t,a){e.exports=a(192)},130:function(e,t,a){},131:function(e,t,a){},133:function(e,t,a){},134:function(e,t,a){},164:function(e,t){},167:function(e,t,a){},168:function(e,t,a){},192:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(10),o=a.n(r),s=a(20),u=a(14),i=a(21),l=Object(i.a)({basename:"/"}),m=(a(130),a(16)),d=a(19),p=a(48),h=a(5),f=a(236),b=Object(h.a)({root:{background:"#27292D"},input:{color:"#ECECEC"}})((function(e){var t,a=e.classes,n=e.value,r=e.onChange,o=e.label,s=e.type;return c.a.createElement(f.a,(t={label:o,value:n,onChange:r,className:a.root,InputProps:{className:a.input}},Object(p.a)(t,"className","s_input"),Object(p.a)(t,"type",s),t))})),v=a(232),E=function(e){var t=e.title,a=e.onClick,n=e.disabled;return c.a.createElement(v.a,{variant:"outlined",onClick:a,className:"s_button",disabled:n},t)},g=function(e){return{type:"@auth/SET_AUTH_DATA",payload:{user:e.user,token:e.token}}},O=function(e){return{type:"LOAD_USERS",payload:e}},k=function(e){return{type:"SET_USERS",payload:e}},j=(a(131),Object(s.b)((function(){return{}}),{signIn:function(e){return{type:"@auth/SIGN_IN",payload:e}}})((function(e){var t=e.signIn,a=Object(n.useState)(""),r=Object(m.a)(a,2),o=r[0],s=r[1],u=Object(n.useState)(""),i=Object(m.a)(u,2),l=i[0],p=i[1];return c.a.createElement("div",{className:"signin__container"},c.a.createElement(b,{label:"Nickname",value:o,onChange:function(e){return s(e.target.value)},className:"s_input"}),c.a.createElement(b,{label:"Password",value:l,onChange:function(e){return p(e.target.value)},className:"s_input",type:"password"}),c.a.createElement(E,{title:"Confirm",disabled:!o||!l,onClick:function(){t({nick:o,password:l})}}),c.a.createElement(d.a,{to:"/signup"},"Registration"))}))),_=(a(133),Object(s.b)((function(){return{}}),{signUp:function(e){return{type:"@auth/SIGN_UP",payload:e}}})((function(e){var t=e.signUp,a=Object(n.useState)(""),r=Object(m.a)(a,2),o=r[0],s=r[1],u=Object(n.useState)(""),i=Object(m.a)(u,2),l=i[0],p=i[1],h=Object(n.useState)(""),f=Object(m.a)(h,2),v=f[0],g=f[1],O=!!o&&!!l&&!!v;return c.a.createElement("div",{className:"signup__container"},c.a.createElement(b,{label:"Nickname *",value:o,onChange:function(e){return s(e.target.value)},className:"s_input"}),c.a.createElement(b,{label:"Password *",value:l,onChange:function(e){return p(e.target.value)},className:"s_input",type:"password"}),c.a.createElement(b,{label:"Email *",value:v,onChange:function(e){return g(e.target.value)},className:"s_input"}),c.a.createElement(E,{title:"Register",disabled:!o||!l,onClick:function(){O&&t({nick:o,password:l,email:v})}}),c.a.createElement(d.a,{to:"/signin"},"Back"))}))),y=(a(134),a(103)),w=a.n(y),S=function(e){return w()("http://localhost:5000",{query:{token:e}})},N=Object(s.b)((function(e){return{token:e.auth.token,id:e.auth.user.id}}),{})((function(e){var t=e.token,a=e.id,r=Object(n.useState)(""),o=Object(m.a)(r,2),s=o[0],u=o[1],i=Object(n.useState)([]),p=Object(m.a)(i,2),h=p[0],f=p[1],b=S(t);return Object(n.useEffect)((function(){return b.emit("chats",{search:s,userId:a}),b.on("chats/".concat(a),f),function(){b.off("chats/".concat(a))}}),[s]),Object(n.useEffect)((function(){return h.forEach((function(e){b.on("notifications/".concat(e.id),(function(e){window.cordova&&(window.cordova.plugins.notification.local.schedule({id:e.chat.id,title:"You have new message in chat - ".concat(e.chat.name),text:e.message,foreground:!0}),window.cordova.plugins.notification.local.on("click",(function(t){t.id==e.chat.id&&l.push("/chat/".concat(e.chat.id))})))}))})),function(){h.forEach((function(e){b.off("notifications/".concat(e.id))}))}}),[h]),c.a.createElement("div",{className:"chat__container"},c.a.createElement("div",{className:"chat_plus"},c.a.createElement(d.a,{to:"/create"},c.a.createElement(E,{title:"+"}))),c.a.createElement("input",{value:s,placeholder:"Search...",onChange:function(e){return u(e.target.value)}}),c.a.createElement("div",{className:"chat_list"},h.map((function(e,t){return c.a.createElement(d.a,{key:t,to:"/chat/".concat(e.id)},e.name)}))))})),C=a(110),I=a(239),x=a(237),U=a(231),A=a(235),T=a(233),P=a(234),R=a(226),D=function(e){var t=e.values,a=e.handleChange,n=e.users;return c.a.createElement(U.a,null,c.a.createElement(I.a,{id:"demo-mutiple-checkbox-label"},"Users"),c.a.createElement(T.a,{labelId:"demo-mutiple-checkbox-label",id:"demo-mutiple-checkbox",multiple:!0,value:t,onChange:a,input:c.a.createElement(R.a,null),renderValue:function(e){return e.map((function(e){return e.nick})).join(", ")}},n.map((function(e){return c.a.createElement(x.a,{key:e.nick,value:e},c.a.createElement(P.a,{checked:t.find((function(t){return t.nick===e.nick}))}),c.a.createElement(A.a,{primary:e.nick}))}))))},B=(a(167),Object(s.b)((function(e){return{id:e.auth.user.id,token:e.auth.token,users:e.auth.users}}),{loadUsers:O})((function(e){var t=e.id,a=e.token,r=e.loadUsers,o=e.users,s=Object(n.useState)(""),u=Object(m.a)(s,2),i=u[0],p=u[1],h=S(a);Object(n.useEffect)((function(){r(t)}),[]);var f=Object(n.useState)([]),v=Object(m.a)(f,2),g=v[0],O=v[1];return c.a.createElement("div",{className:"create-chat__container"},c.a.createElement("div",{className:"chat_plus"},c.a.createElement(d.a,{to:"/"},c.a.createElement(E,{title:"Back"}))),c.a.createElement("div",{className:"create-chat__data"},c.a.createElement(b,{label:"Chat Name",value:i,onChange:function(e){return p(e.target.value)},className:"s_input"}),c.a.createElement(D,{handleChange:function(e){O(e.target.value)},values:g,users:o}),c.a.createElement(E,{title:"Create",disabled:!i,onClick:function(){h.emit("create_chat",{name:i,creator:t,type:"public",users:[t].concat(Object(C.a)(g.map((function(e){return e.id}))))}),l.push("/")}})))}))),L=a(193),G=function(e){var t=e.data;return c.a.createElement("span",null,t.user&&t.user.nick)},W=a(104),q=a.n(W),z=(a(168),Object(s.b)((function(e){return{userId:e.auth.user.id,token:e.auth.token,users:e.auth.users}}),{loadUsers:O})((function(e){var t=e.userId,a=e.token,r=e.loadUsers,o=e.users,s=Object(n.useState)(""),u=Object(m.a)(s,2),i=u[0],p=u[1],h=Object(n.useState)([]),f=Object(m.a)(h,2),b=f[0],v=f[1],g=Object(n.useState)([]),O=Object(m.a)(g,2),k=O[0],j=O[1],_=Object(n.useState)(!1),y=Object(m.a)(_,2),w=y[0],N=y[1],C=Object(n.useState)([]),I=Object(m.a)(C,2),x=I[0],U=I[1],A=Object(n.useState)([]),T=Object(m.a)(A,2),P=T[0],R=T[1],B=function(e){var t=e.split("/");return t[t.length-1]}(l.location.pathname),W=S(a);Object(n.useEffect)((function(){var e=[];o.forEach((function(t){b.find((function(e){return e.user.id===t.id}))||e.push(t)})),R(e)}),[o,b]),Object(n.useEffect)((function(){return W.emit("entry_to_chat",{userId:t,chatId:B}),W.on("chat_members/".concat(B),v),W.on("messages/".concat(B),j),function(){W.off("chat_members/".concat(B)),W.off("messages/".concat(B,"/").concat(t))}}),[]);return c.a.createElement("div",{className:"chat_body"},c.a.createElement("div",{className:"chat_body_leave"},c.a.createElement(d.a,{to:"/"},c.a.createElement(E,{title:"Back"})),c.a.createElement("a",null,c.a.createElement(E,{title:"Add users",onClick:function(){N(!0),r(t)}})),c.a.createElement(d.a,{to:"/"},c.a.createElement(E,{title:"Leave Chat",onClick:function(){W.emit("leave_chat",{userId:t,chatId:B})}}))),c.a.createElement("div",{className:"chat_body_wrap"},w&&c.a.createElement("div",{className:"private"},c.a.createElement("div",{className:"chat_body_leave"},c.a.createElement(E,{title:"Close",onClick:function(){N(!1),U([])}})),c.a.createElement(D,{handleChange:function(e){U(e.target.value)},values:x,users:P}),c.a.createElement(E,{title:"Add Users",onClick:function(){W.emit("add_new_members_to_chat",{chatId:B,users:x.map((function(e){return e.id}))}),N(!1),U([])}})),c.a.createElement("div",{className:"chat_body_members"},b.map((function(e,t){return c.a.createElement(G,{key:t,data:e})}))),c.a.createElement("div",{className:"chat_body_messages"},c.a.createElement("div",{className:"messages_list"},k.map((function(e){return c.a.createElement("div",{key:e.id},c.a.createElement("span",{className:"msg_name"},e.user&&e.user.nick),c.a.createElement("span",{className:"msg_msg"},function(e){return q()(e,{mimeRequired:!0})?c.a.createElement("img",{src:e}):e}(e.message)))}))),c.a.createElement("div",{className:"messages_inputs"},c.a.createElement(L.a,{"aria-label":"empty textarea",onChange:function(e){return p(e.target.value)},value:i,className:"message_input"}),c.a.createElement(E,{title:"Send",disabled:!i,onClick:function(){W.emit("send_message",{msgOptions:{message:i,chatId:B,userId:t},userOptions:{chatId:B,userId:t}}),p("")}}),c.a.createElement(E,{title:"Picture",onClick:function(){window.cordova&&navigator.camera.getPicture((function(e){W.emit("send_message",{msgOptions:{message:"data:image/png;base64,"+e,chatId:B,userId:t},userOptions:{chatId:B,userId:t}})}),(function(e){return console.log(e)}),{destinationType:navigator.camera.DestinationType.DATA_URL})}})))))}))),H=function(){return c.a.createElement(u.c,{history:l},c.a.createElement(u.d,null,c.a.createElement(u.b,{exact:!0,path:"/",component:N}),c.a.createElement(u.b,{path:"/create",component:B}),c.a.createElement(u.b,{path:"/chat/:id",component:z}),c.a.createElement(u.a,{to:"/"})))},J=Object(s.b)((function(e){return{token:e.auth.token}}),{})((function(e){var t=e.token;return c.a.createElement(u.c,{history:l},c.a.createElement("div",{className:"app"},t?c.a.createElement(u.d,null,c.a.createElement(u.b,{path:"/",component:H}),c.a.createElement(u.a,{to:"/"})):c.a.createElement(u.d,null,c.a.createElement(u.b,{exact:!0,path:"/signin",component:j}),c.a.createElement(u.b,{path:"/signup",component:_}),c.a.createElement(u.a,{to:"/signin"}))))})),F=a(105),M=a(18),V=a(74),Y=a(111),$=a(106),K=a(107),Q=a.n(K),X=a(51),Z={user:{},token:null,users:[]};var ee=Object(M.combineReducers)({auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"@auth/SET_AUTH_DATA":return Object(X.a)(Object(X.a)({},e),{},{user:t.payload.user,token:t.payload.token});case"SET_USERS":return Object(X.a)(Object(X.a)({},e),{},{users:t.payload});default:return e}}}),te=a(26),ae=a.n(te),ne=a(27),ce=a(108),re=a.n(ce),oe=a(109),se=a.n(oe);function ue(e){var t=e.method,a=e.url,n=e.data,c=e.params,r=localStorage.getItem("auth"),o={method:t.toLowerCase(),url:"http://localhost:5000"+a,params:c,paramsSerializer:function(e){return se.a.stringify(e,{arrayFormat:"repeat"})}};return n&&(o.data=n),o.headers={"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},r&&(o.headers={Authorization:"Bearer "+r}),re()(o)}var ie=ae.a.mark(pe),le=ae.a.mark(he),me=ae.a.mark(fe),de=ae.a.mark(be);function pe(e){var t;return ae.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,localStorage.removeItem("auth"),a.next=4,Object(ne.b)(ue,{url:"/signin",method:"POST",data:e.payload});case 4:return t=a.sent,localStorage.setItem("auth",t.data.token),a.next=8,Object(ne.c)(g({token:t.data.token,user:t.data.user}));case 8:a.next=13;break;case 10:a.prev=10,a.t0=a.catch(0),console.log(a.t0);case 13:case"end":return a.stop()}}),ie,null,[[0,10]])}function he(e){var t;return ae.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(ne.b)(ue,{url:"/signup",method:"POST",data:e.payload});case 3:return t=a.sent,localStorage.setItem("auth",t.data.token),a.next=7,Object(ne.c)(g({token:t.data.token,user:t.data.user}));case 7:a.next=12;break;case 9:a.prev=9,a.t0=a.catch(0),console.log(a.t0);case 12:case"end":return a.stop()}}),le,null,[[0,9]])}function fe(e){var t;return ae.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(ne.b)(ue,{url:"/users/".concat(e.payload),method:"GET"});case 3:return t=a.sent,a.next=6,Object(ne.c)(k(t.data));case 6:a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),console.log(a.t0);case 11:case"end":return a.stop()}}),me,null,[[0,8]])}function be(){return ae.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ne.d)("@auth/SIGN_IN",pe);case 2:return e.next=4,Object(ne.d)("@auth/SIGN_UP",he);case 4:return e.next=6,Object(ne.d)("LOAD_USERS",fe);case 6:case"end":return e.stop()}}),de)}var ve=ae.a.mark((function e(){return ae.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ne.a)([be()]);case 2:case"end":return e.stop()}}),e)})),Ee=Object($.composeWithDevTools)({maxAge:25,latency:1500}),ge=Object(Y.a)(),Oe={key:"Chat",storage:Q.a,blacklist:[]},ke=Object(V.a)(Oe,ee);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var je=function(){var e=Object(M.createStore)(ke,Ee(Object(M.applyMiddleware)(ge)));return ge.run(ve),{persistor:Object(V.b)(e),store:e}}(),_e=je.persistor,ye=je.store,we=function(){o.a.render(c.a.createElement(s.a,{store:ye},c.a.createElement(F.a,{persistor:_e},c.a.createElement(J,null))),document.getElementById("root"))};window.cordova?document.addEventListener("deviceready",(function(){we()}),!1):we(),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[121,1,2]]]);
//# sourceMappingURL=main.5ff88454.chunk.js.map